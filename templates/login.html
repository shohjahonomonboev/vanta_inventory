{% extends "base.html" %}
{% block title %}{{ t('admin_login') }} — Jasurbek{% endblock %}

{% block content %}
<div class="auth-wrap a-fade" data-once>
  <div class="auth-card glass a-pop">
    <h1 class="auth-title a-down">{{ t('admin_login') }}</h1>

    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        <div class="flash-stack a-up" role="status" aria-live="polite">
          {% for cat, msg in messages %}
            <div class="flash {{ cat }}">{{ msg }}</div>
          {% endfor %}
        </div>
      {% endif %}
    {% endwith %}

    <form method="POST" action="{{ url_for('login') }}" class="auth-form stagger" novalidate>
      <label class="field a-up">
        <span class="field-icon"><i class="fa-regular fa-user" aria-hidden="true"></i></span>
        <input
          class="input"
          type="text"
          name="username"
          placeholder="{{ t('username') }}"
          autocomplete="username"
          required
          autofocus
        >
      </label>

      <label class="field a-up">
        <span class="field-icon"><i class="fa-solid fa-lock" aria-hidden="true"></i></span>
        <input
          class="input"
          type="password"
          id="pw"
          name="password"
          placeholder="{{ t('password') }}"
          autocomplete="current-password"
          required
        >
        <button type="button" class="pw-toggle" aria-label="Show password">
          <i class="fa-regular fa-eye" aria-hidden="true"></i>
        </button>
      </label>

      <button type="submit" class="btn btn-primary w-full a-up">{{ t('login') }}</button>

      <div class="auth-footer a-up">
        <a href="{{ url_for('forgot_password') }}">{{ t('forgot_password') }}</a>
        <span class="version">{{ t('version') }}: {{ APP_VERSION }}</span>
      </div>
    </form>
  </div>
</div>

<script>
  (function () {
    const btn = document.querySelector('.pw-toggle');
    const pw  = document.getElementById('pw');
    if (!btn || !pw) return;
    btn.addEventListener('click', () => {
      const show = pw.type === 'password';
      pw.type = show ? 'text' : 'password';
      btn.innerHTML = show
        ? '<i class="fa-regular fa-eye-slash" aria-hidden="true"></i>'
        : '<i class="fa-regular fa-eye" aria-hidden="true"></i>';
      btn.setAttribute('aria-label', show ? 'Hide password' : 'Show password');
    });
  }());
</script>
{% endblock %}
